
.HAS2
 STA S
 STY YSAV
 LSR A
 LSR A
 LSR A
 CLC
 ADC LDA18,Y
 STA L00BA
 LDA L00E6
 ADC LDAF8,Y
 STA L00BB
 LDA S
 AND #7
 STA T
.CB5D9
 CHECK_DASHBOARD        \ If the PPU has started drawing the dashboard, switch
                        \ to nametable 0 (&2000) and pattern table 0 (&0000)
 LDX #0
 LDA (L00BA,X)
 BEQ CB615
 LDX L00B9
 STX SC+1
 ASL A
 ROL SC+1
 ASL A
 ROL SC+1
 ASL A
 ROL SC+1
 STA SC
 LDY #0
 LDX T
.loop_CB5FF
 LDA (SC),Y
 AND LD9F7,X
 BNE CB62A
 LDA (SC),Y
 ORA LD9F7,X
 STA (SC),Y
 INY
 CPY #8
 BNE loop_CB5FF
 JMP CB61C

.CB615
 LDA T
 CLC
 ADC #&34
 STA (L00BA,X)
.CB61C
 LDA L00BA
 CLC
 ADC #&20
 STA L00BA
 BCC CB5D9
 INC L00BB
 JMP CB5D9

.CB62A
 LDA S
 LDY YSAV
 RTS

.HAL3
 STX R
 STY YSAV
 LSR A
 LSR A
 LSR A
 CLC
 ADC LDA18,Y
 STA L00BA
 LDA L00E6
 ADC LDAF8,Y
 STA L00BB
 TYA
 AND #7
 TAY
.CB647
 CHECK_DASHBOARD        \ If the PPU has started drawing the dashboard, switch
                        \ to nametable 0 (&2000) and pattern table 0 (&0000)
 LDX #0
 LDA (L00BA,X)
 BEQ CB699
 LDX L00B9
 STX SC+1
 ASL A
 ROL SC+1
 ASL A
 ROL SC+1
 ASL A
 ROL SC+1
 STA SC
 LDA (SC),Y
 BEQ CB685
 LDA #&80
.loop_CB66F
 STA T
 AND (SC),Y
 BNE CB67C
 LDA T
 SEC
 ROR A
 JMP loop_CB66F

.CB67C
 LDA T
 ORA (SC),Y
 STA (SC),Y
 LDY YSAV
 RTS

.CB685
 LDA #&FF
 STA (SC),Y
.loop_CB689
 DEC R
 BEQ CB696
 INC L00BA
 BNE CB647
 INC L00BB
 JMP CB647

.CB696
 LDY YSAV
 RTS

.CB699
 TYA
 CLC
 ADC #&25
 STA (L00BA,X)
 JMP loop_CB689
